CREATE DATABASE MOA_DB;

USE MOA_DB;

-- 사용자 테이블 생성
CREATE TABLE TBL_MOA_USER_BAS(
CUST_IDFY_SEQ int NOT NULL auto_increment PRIMARY KEY,
USER_ID VARCHAR(11) NOT NULL,
USER_PWD VARCHAR(256) NOT NULL,
USER_TEL_NO VARCHAR(12) NOT NULL,
USER_NM VARCHAR(60) NOT NULL,
UPLD_CASCNT int NOT NULL,
TEAM_DIV_CD VARCHAR(3) NOT NULL,
EMP_POS_DIV_CD VARCHAR(3) NOT NULL
);
 
 
 -- 자동화 세부정보 테이블 생성
CREATE TABLE TBL_MOA_BAS(
FILE_SEQ int NOT NULL auto_increment PRIMARY KEY,
CUST_IDFY_SEQ int NOT NULL,
SROC_FILE_PATH_NM VARCHAR(60) NOT NULL,
LANG_CD VARCHAR(3) NOT NULL,
SYS_DIV_CD VARCHAR(3) NOT NULL,
CYCL_DATE_TYPE_CD VARCHAR(3) NOT NULL,
DOW_NM VARCHAR(60),
EXE_DATE DATE NOT NULL,
RPY_RESLT_CD VARCHAR(3) NOT NULL,
TROBL_SVC_TYPE_CD VARCHAR(3) NOT NULL,
INPUT_VAL VARCHAR(50),
TRT_STEP_NM VARCHAR(60) NOT NULL,
CONN_EVN_DIV_CD VARCHAR(3) NOT NULL,
ATTEN_MTR_SBST VARCHAR(1000),
ATC_FILE_MANUAL_YN VARCHAR(1) NOT NULL,
ATC_FILE_UPLD_PATH_NM VARCHAR(200),
OTPUT_SBST VARCHAR(2000),
ETC_SBST VARCHAR(1000),
EXE_SBST VARCHAR(1000) NOT NULL,
NTCART_TITLE_NM VARCHAR(60) NOT NULL,
TKCGR_NM VARCHAR(60) NOT NULL,
RUSER_NM VARCHAR(60) NOT NULL,
FIRST_REG_DATE DATE NOT NULL,
CHG_DATE DATE NOT NULL,
FNS_DATE DATE NOT NULL,
FOREIGN KEY(CUST_IDFY_SEQ) REFERENCES TBL_MOA_USER_BAS(CUST_IDFY_SEQ)
);

-- 자동화 세부정보 이력 테이블 생성
CREATE TABLE TBL_MOA_HST(
STTUS_CHG_HST_SEQ INT NOT NULL auto_increment PRIMARY KEY,
FILE_SEQ INT NOT NULL,
CUST_IDFY_SEQ INT NOT NULL,
SROC_FILE_PATH_NM VARCHAR(60) NOT NULL,
LANG_CD VARCHAR(3) NOT NULL,
SYS_DIV_CD VARCHAR(3) NOT NULL,
CYCL_DATE_TYPE_CD VARCHAR(3) NOT NULL,
DOW_NM VARCHAR(60),
EXE_DATE DATE NOT NULL,
RPY_RESLT_CD VARCHAR(3) NOT NULL,
TROBL_SVC_TYPE_CD VARCHAR(3) NOT NULL,
INPUT_VAL VARCHAR(50),
TRT_STEP_NM VARCHAR(60) NOT NULL,
CONN_EVN_DIV_CD VARCHAR(3) NOT NULL,
ATTEN_MTR_SBST VARCHAR(1000),
ATC_FILE_MANUAL_YN VARCHAR(1) NOT NULL,
ATC_FILE_UPLD_PATH_NM VARCHAR(200),
OTPUT_SBST VARCHAR(2000),
ETC_SBST VARCHAR(1000),
EXE_SBST VARCHAR(1000) NOT NULL,
NTCART_TITLE_NM VARCHAR(60) NOT NULL,
TKCGR_NM VARCHAR(60) NOT NULL,
RUSER_NM VARCHAR(60) NOT NULL,
LAST_HST_YN VARCHAR(1),
FILE_UPD_YN VARCHAR(1) NOT NULL,
STTUS_DIV_CD VARCHAR(3) NOT NULL,
FOREIGN KEY(FILE_SEQ) REFERENCES TBL_MOA_BAS(FILE_SEQ),
FOREIGN KEY(CUST_IDFY_SEQ) REFERENCES TBL_MOA_BAS(CUST_IDFY_SEQ)
);

-- 실행 테이블 생성
CREATE TABLE TBL_MOA_EXECUTION_TXN(
EXE_SEQ INT NOT NULL auto_increment PRIMARY KEY,
FILE_SEQ INT NOT NULL,
CUST_IDFY_SEQ INT NOT NULL,
EXE_EMP_NM VARCHAR(30) NOT NULL,
EXE_DATE DATE NOT NULL,
LAST_HST_YN VARCHAR(1),
ERR_YN VARCHAR(1) NOT NULL,
ERR_MSG_SBST VARCHAR(1000),
FOREIGN KEY(FILE_SEQ) REFERENCES TBL_MOA_BAS(FILE_SEQ),
FOREIGN KEY(CUST_IDFY_SEQ) REFERENCES TBL_MOA_BAS(CUST_IDFY_SEQ)
);

-- 코드공통 테이블 생성
CREATE TABLE TBL_MOA_CD_BAS(
ITG_CD_GROUP_ID VARCHAR(5) NOT NULL,
ITG_CD_GROUP_NM VARCHAR(60) NOT NULL,
CD_ID VARCHAR(30) NOT NULL,
CD_NM VARCHAR(60) NOT NULL,
RFRN_VAL1 VARCHAR(100),
RFRN_VAL2 VARCHAR(100)
);
